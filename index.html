<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<title>Who's Driving?</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<!-- Styles -->
		<style type="text/css">
			body {
				font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans", "Droid Sans", "Helvetica Neue", sans-serif;
				font-size: 112.5%;
				max-width: 40em;
				width: 88%;
				margin-left: auto;
				margin-right: auto;
			}

			/**
			 * Form styles
			 */

			label,
			input {
				display: block;
				width: 100%;
			}
		</style>
	</head>

	<body>

		<h1>Who's Driving?</h1>

		<div id="app"></div>

		<form id="add-driver">
			<label for="driver-name">Add a name to the list of possible drivers</label>
			<input type="text" id="driver-name">
			<button>Add a Driver</button>
		</form>

		<p>
			<button id="pick-driver">Pick a Driver</button>
			<button id="clear-drivers">Remove All Drivers</button>
		</p>

		<script src="component.js"></script>
		<script>

			//== Methods ==//

			/*!
			 * Sanitize and encode all HTML in a user-submitted string
			 * (c) 2018 Chris Ferdinandi, MIT License, https://gomakethings.com
			 * @param  {String} str  The user-submitted string
			 * @return {String} str  The sanitized string
			 */
			var sanitizeHTML = function (str) {
				var temp = document.createElement('div');
				temp.textContent = str;
				return temp.innerHTML;
			};

			// Create app component
			var app = new Component('#app', {
				data: {
					drivers: [],
					selected: null
				},
				template: function(props) {
					// Make sure there's at least 1 driver
					if (props.drivers.length < 1) return '<p><em>To get started, add a couple of drivers using the form below.</em></p>';

					// Create selected driver markup
					var selected = '';
					if (props.selected) {
						selected = '<p><strong>' + sanitizeHTML(props.selected) + ' is the driver.</strong></p>';
					}

					// Display list of drivers
					return '<ul>' + props.drivers.map(function(driver, index) {
						var name = sanitizeHTML(driver);
						return '<li>' + name + ' <button data-driver="' + index + '" aria-label="Remove ' + name + '">Remove</button></li>';
					}).join('') + '</ul>' + selected;
				}
      });

			var submitHandler = function(event) {
				// Make sure submitted form is #add-driver form
				if (event.target.id !== 'add-driver') return;

				// Prevent form from submitting to server
				event.preventDefault();

				// Get the driver name
				var input = document.querySelector('#driver-name');
				if (!input || input.value < 1) return;

				// Update the data and UI
				var data = app.getData();
				data.drivers.push(input.value);
				app.setData({drivers: data.drivers});

				// Clear input field and return focus
				input.value = '';
				input.focus();
			}

			//== Inits & Event Listeners ==//

			// Render app
			app.render();

			// Listen for form submissions
			document.addEventListener('submit', submitHandler, false);

		</script>
	</body>
</html>
